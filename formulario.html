<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Orden de Trabajo (BEO) - Restaurante El Rodeo</title>
<style>
body {
    font-family: Arial, sans-serif;
    background-color: #fff;
    color: #000;
    margin: 15px;
}
h2 {
    text-align: center;
    background-color: #4da6ff;
    color: white;
    padding: 5px 0;
    border-radius: 4px;
    margin-top: 10px;
    margin-bottom: 10px;
}
table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 8px;
    font-size: 13px;
}
th, td {
    border: 1px solid #555;
    padding: 6px 5px;
    text-align: left;
    vertical-align: middle;
    word-wrap: break-word;
}
th {
    background-color: #e6f3ff;
    font-weight: bold;
}
.section-title {
    background-color: #4da6ff;
    color: #fff;
    font-weight: bold;
    text-align: left;
    padding: 5px;
}
button {
    background-color: #4da6ff;
    color: #fff;
    border: none;
    padding: 8px 15px;
    margin: 5px;
    font-weight: bold;
    cursor: pointer;
    border-radius: 5px;
}
button:hover {
    background-color: #2e7ed6;
}
@media print {
    button { display: none; } /* Oculta los botones al imprimir */
    body {
        margin: 10mm; /* M√°rgenes de p√°gina carta */
        -webkit-print-color-adjust: exact; /* Mantiene colores */
        print-color-adjust: exact;
    }
}
</style>
</head>
<body>

<h2>ORDEN DE TRABAJO (BEO) - RESERVACIONES EVENTOS</h2>

<!-- DATOS DEL EVENTO -->
<table>
    <tr>
        <th style="width: 12%;">N¬∞ de Reserva</th>
        <td style="width: 10%;"></td>
        <th style="width: 10%;">Fecha</th>
        <td style="width: 18%;"></td>
        <th style="width: 10%;">Hora inicio</th>
        <td style="width: 18%;"></td>
        <th style="width: 12%;">Hora finalizaci√≥n</th>
        <td style="width: 20%;"></td>
    </tr>
    <tr>
        <th>Sal√≥n</th>
        <td style="width: 10%;"></td>
        <th>Tipo de evento</th>
        <td colspan="5"></td>
    </tr>
</table>

<!-- DATOS DEL CLIENTE -->
<table>
    <tr>
        <th style="width: 20%;">Facturar a nombre de:</th>
        <td style="width: 25%;"></td>
        <th style="width: 10%;">Tel√©fono:</th>
        <td style="width: 15%;"></td>
        <th style="width: 12%;">N¬∞ Personas:</th>
        <td style="width: 18%;"></td>
    </tr>
    <tr>
        <th>Nombre en cartera:</th>
        <td></td>
        <th>C√≥digo:</th>
        <td colspan="3"></td>
    </tr>
    <tr>
        <th>Contacto comercial:</th>
        <td></td>
        <th>Contacto en evento:</th>
        <td></td>
        <th>Tel. contacto:</th>
        <td></td>
    </tr>
    <tr>
        <th>Responsable de pago:</th>
        <td></td>
        <th>DUI:</th>
        <td></td>
        <th>NIT:</th>
        <td></td>
    </tr>
    <tr>
        <th>Ejecutiva de ventas:</th>
        <td></td>
        <th>Tel√©fono:</th>
        <td></td>
        <th>Celular:</th>
        <td></td>
    </tr>
</table>

<!-- MONTAJE Y COCINA -->
<table>
    <tr>
        <th colspan="2" class="section-title">MONTAJE</th>
        <th colspan="2" class="section-title">COCINA</th>
    </tr>
    <tr style="height: 150px;">
        <td colspan="2" id="montajeData" style="vertical-align: top;"></td>
        <td colspan="2" id="cocinaData" style="vertical-align: top;"></td>
    </tr>
</table>

<!-- MANTENIMIENTO -->
<h2>MANTENIMIENTO</h2>
<table id="tablaMantenimiento">
    <tr>
        <th>N¬∞ Ingreso Caja</th><th>Fecha</th><th>Valor</th>
        <th>N¬∞ Ingreso Caja</th><th>Fecha</th><th>Valor</th>
    </tr>
    <tr><td colspan="6" style="height: 90px;"></td></tr>
</table>

<!-- PRODUCTOS Y SERVICIOS -->
<h2>PRODUCTOS Y SERVICIOS</h2>
<table id="productosServicios">
    <tr>
        <th style="width: 10%;">C√≥digo</th>
        <th style="width: 50%;">Descripci√≥n</th>
        <th style="width: 10%;">Cantidad</th>
        <th style="width: 12%;">Precio Uni.</th>
        <th style="width: 13%;">Valor</th>
    </tr>
    <tr style="height: 28px;"><td></td><td></td><td></td><td></td><td></td></tr>
    <tr style="height: 28px;"><td></td><td></td><td></td><td></td><td></td></tr>
    <tr style="height: 28px;"><td></td><td></td><td></td><td></td><td></td></tr>
    <tr style="height: 28px;"><td></td><td></td><td></td><td></td><td></td></tr>
    <tr style="height: 28px;"><td></td><td></td><td></td><td></td><td></td></tr>
</table>

<table>
    <tr>
        <th colspan="2" style="text-align: left;">Servicios adicionales</th>
        <th colspan="3" style="text-align: left;">TOTAL ORDEN</th>
        <td id="totalOrden" style="font-weight: bold; text-align: right;">$0.00</td>
    </tr>
</table>

<!-- FIRMAS -->
<table>
    <tr>
        <td style="height: 80px; text-align: center;">_______________________<br>GERENTE</td>
        <td style="text-align: center;">_______________________<br>VENTAS</td>
        <td style="text-align: center;">_______________________<br>CLIENTE</td>
        <td style="text-align: center;">_______________________<br>COCINA</td>
        <td style="text-align: center;">_______________________<br>MANTENIMIENTO</td>
    </tr>
</table>

<!-- SOLO BOT√ìN DE IMPRIMIR -->
<div style="text-align: center; margin-top: 15px;">
    <button onclick="window.print()">üñ®Ô∏è Imprimir</button>
</div>

<!-- SCRIPT ORIGINAL PARA LLENAR DATOS -->
<script>
const params = new URLSearchParams(window.location.search);
const reservaId = params.get('id');

if (reservaId) {
    const reservas = JSON.parse(localStorage.getItem('reservas') || '[]');
    const reserva = reservas.find(r => r.id === reservaId);

    if (reserva) {
        const t0 = document.querySelectorAll('table')[0].rows;
        t0[0].cells[1].textContent = reserva.id;
        t0[0].cells[3].textContent = reserva.fechaEvento || '';
        t0[0].cells[5].textContent = reserva.horaInicio || '';
        t0[0].cells[7].textContent = reserva.horaFin || '';
        t0[1].cells[1].textContent = reserva.salon || '';
        t0[1].cells[3].textContent = reserva.tipoEvento || '';

        const t1 = document.querySelectorAll('table')[1].rows;
        t1[0].cells[1].textContent = reserva.facturarA || '';
        t1[0].cells[3].textContent = reserva.telefono || '';
        t1[0].cells[5].textContent = reserva.numPersonas || '';
        t1[1].cells[1].textContent = reserva.nombreCartera || '';
        t1[1].cells[3].textContent = reserva.codigo || '';
        t1[2].cells[1].textContent = reserva.contactoComercial || '';
        t1[2].cells[3].textContent = reserva.contactoEvento || '';
        t1[2].cells[5].textContent = reserva.telContacto || '';
        t1[3].cells[1].textContent = reserva.responsablePago || '';
        t1[3].cells[3].textContent = reserva.dui || '';
        t1[3].cells[5].textContent = reserva.nit || '';
        t1[4].cells[1].textContent = reserva.ejecutivaVentas || '';
        t1[4].cells[3].textContent = reserva.telEjecutiva || '';
        t1[4].cells[5].textContent = reserva.celEjecutiva || '';

        // MONTAJE Y COCINA
        if (reserva.montaje && reserva.montaje.length)
            document.getElementById('montajeData').textContent = reserva.montaje.map(m => `${m.tipo}: ${m.cantidad}`).join(', ');
        if (reserva.cocina && reserva.cocina.length)
            document.getElementById('cocinaData').textContent = reserva.cocina.map(c => `${c.item}: ${c.cantidad}`).join(', ');

        // MANTENIMIENTO
        const tablaM = document.getElementById('tablaMantenimiento');
        if (reserva.mantenimiento && reserva.mantenimiento.length) {
            while (tablaM.rows.length > 1) tablaM.deleteRow(1);
            for (let i = 0; i < reserva.mantenimiento.length; i += 2) {
                const row = tablaM.insertRow();
                const m1 = reserva.mantenimiento[i];
                const m2 = reserva.mantenimiento[i + 1];
                row.insertCell().textContent = m1?.n || '';
                row.insertCell().textContent = m1?.fecha || '';
                row.insertCell().textContent = m1?.valor || '';
                row.insertCell().textContent = m2?.n || '';
                row.insertCell().textContent = m2?.fecha || '';
                row.insertCell().textContent = m2?.valor || '';
            }
        }

        // PRODUCTOS Y SERVICIOS + TOTAL
        const tablaP = document.getElementById('productosServicios').rows;
        let total = 0;
        if (reserva.productos && reserva.productos.length) {
            reserva.productos.forEach((p, i) => {
                if (i + 1 < tablaP.length) {
                    tablaP[i + 1].cells[0].textContent = p.codigo || '';
                    tablaP[i + 1].cells[1].textContent = p.descripcion || '';
                    tablaP[i + 1].cells[2].textContent = p.cantidad || '';
                    tablaP[i + 1].cells[3].textContent = p.precio || '';
                    const valor = parseFloat(p.valor || (p.cantidad * p.precio)) || 0;
                    tablaP[i + 1].cells[4].textContent = valor.toFixed(2);
                    total += valor;
                }
            });
        }
        document.getElementById('totalOrden').textContent = `$${total.toFixed(2)}`;
    }
}
</script>
</body>
</html>